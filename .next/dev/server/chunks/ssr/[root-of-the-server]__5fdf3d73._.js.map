{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/riyadia/Desktop/globaltax-saas/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n// Logika deteksi di Browser Console (Tekan F12 untuk cek)\nif (typeof window !== 'undefined') {\n  console.log(\"Menghubungkan ke Supabase URL:\", supabaseUrl);\n}\n\n// Jika salah satu kosong, hentikan proses dengan pesan yang jelas\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error(\"CRITICAL: NEXT_PUBLIC_SUPABASE_URL atau ANON_KEY tidak ditemukan di .env.local. Cek lokasi file dan restart terminal.\");\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN,0DAA0D;AAC1D;;AAIA,kEAAkE;AAClE;;AAIO,MAAM,WAAW,IAAA,8LAAY,EAAC,aAAa"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///Users/riyadia/Desktop/globaltax-saas/app/dashboard/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { useRouter } from 'next/navigation';\nimport { \n  ShieldCheck, Key, History, Download, Zap, User, \n  Loader2, LogOut, CheckCircle2 \n} from 'lucide-react';\n\nexport default function DashboardPage() {\n  const router = useRouter();\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [message, setMessage] = useState<{ type: 'success' | 'error', text: string } | null>(null);\n  \n  // State Profile lengkap sesuai kolom di tabel profiles\n  const [profile, setProfile] = useState({\n    id: '',\n    full_name: '',\n    is_pro: false,\n    openai_key: '',\n    anthropic_key: '',\n    gemini_key: '',\n    mistral_key: '',\n    llama_key: ''\n  });\n\n  // 1. Ambil data profil saat halaman dibuka\n  useEffect(() => {\n    const fetchProfile = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      \n      if (!user) {\n        router.push('/auth/login');\n        return;\n      }\n\n      const { data } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', user.id)\n        .single();\n\n      if (data) {\n        setProfile({\n          id: data.id,\n          full_name: data.full_name || '',\n          is_pro: data.is_pro || false,\n          openai_key: data.openai_key || '',\n          anthropic_key: data.anthropic_key || '',\n          gemini_key: data.gemini_key || '',\n          mistral_key: data.mistral_key || '',\n          llama_key: data.llama_key || ''\n        });\n      }\n      setLoading(false);\n    };\n\n    fetchProfile();\n  }, [router]);\n\n  // 2. Fungsi simpan data ke Vault\n  const handleUpdateKeys = async () => {\n    setSaving(true);\n    setMessage(null);\n    \n    const { error } = await supabase\n      .from('profiles')\n      .update({\n        openai_key: profile.openai_key,\n        anthropic_key: profile.anthropic_key,\n        gemini_key: profile.gemini_key,\n        mistral_key: profile.mistral_key,\n        llama_key: profile.llama_key\n      })\n      .eq('id', profile.id);\n\n    if (error) {\n      setMessage({ type: 'error', text: 'Failed to update vault.' });\n    } else {\n      setMessage({ type: 'success', text: 'Intelligence Vault updated successfully.' });\n      setTimeout(() => setMessage(null), 3000);\n    }\n    setSaving(false);\n  };\n\n  const handleSignOut = async () => {\n    await supabase.auth.signOut();\n    router.push('/');\n  };\n\n  // URL Checkout dengan ID user untuk tracking otomatis\n  const checkoutUrl = `${process.env.NEXT_PUBLIC_LEMON_SQUEEZY_CHECKOUT_URL}?checkout[custom][user_id]=${profile.id}`;\n\n  if (loading) return (\n    <div className=\"min-h-screen bg-[#FDFCFB] flex items-center justify-center\">\n      <Loader2 className=\"animate-spin text-[#D4AF37] w-12 h-12\" />\n    </div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-[#FDFCFB] text-black pb-32\">\n      {/* 1. DASHBOARD HEADER */}\n      <section className=\"max-w-6xl mx-auto pt-24 pb-12 px-8\">\n        <div className=\"flex flex-col md:flex-row justify-between items-end gap-8\">\n          <div className=\"space-y-4\">\n            <div className={`inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-[12px] font-black uppercase tracking-[0.3em] ${profile.is_pro ? 'bg-black text-[#D4AF37]' : 'bg-gray-100 text-gray-400'}`}>\n              <ShieldCheck className=\"w-4 h-4\" /> {profile.is_pro ? 'Verified Pro Account' : 'Standard Account'}\n            </div>\n            <h1 className=\"text-5xl font-serif italic text-black leading-tight\">Command <span className=\"text-[#D4AF37]\">Center.</span></h1>\n            <p className=\"text-[16px] text-gray-400 font-light italic leading-relaxed\">Manage your elite fiscal intelligence assets and API integration.</p>\n          </div>\n          <div className=\"flex gap-4 no-print items-center\">\n            {!profile.is_pro && (\n              <a href={checkoutUrl} className=\"px-8 py-3 bg-[#D4AF37] text-black rounded-full text-[14px] font-black uppercase tracking-widest hover:bg-black hover:text-[#D4AF37] transition-all flex items-center gap-3 shadow-lg shadow-gold/20\">\n                <Zap size={16} /> Upgrade Pro\n              </a>\n            )}\n            <button onClick={handleSignOut} className=\"px-8 py-3 bg-white border border-gray-100 rounded-full text-[14px] font-black uppercase tracking-widest hover:bg-gray-50 transition-all flex items-center gap-3\">\n              <LogOut size={16} /> Sign Out\n            </button>\n          </div>\n        </div>\n      </section>\n\n      {/* 2. THE VAULT: API KEY MANAGEMENT */}\n      <section className=\"max-w-6xl mx-auto px-8 mb-20\">\n        <div className=\"bg-white border border-gray-100 rounded-[3rem] p-12 shadow-2xl shadow-gray-100/50\">\n          <div className=\"flex items-center justify-between mb-12 border-b border-gray-50 pb-6\">\n            <div className=\"flex items-center gap-4\">\n              <Key className=\"text-[#D4AF37]\" />\n              <h2 className=\"text-[14px] font-black uppercase tracking-[0.4em]\">Intelligence API Vault</h2>\n            </div>\n            {message && (\n              <div className={`text-[13px] font-bold flex items-center gap-2 ${message.type === 'success' ? 'text-green-600' : 'text-red-500'}`}>\n                {message.type === 'success' && <CheckCircle2 size={16} />} {message.text}\n              </div>\n            )}\n          </div>\n          \n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {[\n              { id: 'openai_key', provider: \"OpenAI\", model: \"GPT-5.2 / o3\" },\n              { id: 'anthropic_key', provider: \"Anthropic\", model: \"Claude 4.5 Opus\" },\n              { id: 'gemini_key', provider: \"Google Gemini\", model: \"Gemini 3 Ultra\" },\n              { id: 'mistral_key', provider: \"Mistral AI\", model: \"Mistral Large 3\" },\n              { id: 'llama_key', provider: \"Meta Llama\", model: \"Llama 4 (70B)\" }\n            ].map((api, i) => (\n              <div key={i} className=\"p-8 bg-[#FDFCFB] rounded-3xl border border-gray-50 space-y-6 group hover:border-[#D4AF37]/30 transition-all\">\n                <div className=\"flex justify-between items-start\">\n                  <span className=\"text-[14px] font-bold text-black\">{api.provider}</span>\n                  <div className={`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest ${(profile as any)[api.id] ? 'bg-green-50 text-green-600' : 'bg-gray-100 text-gray-400'}`}>\n                    {(profile as any)[api.id] ? 'Active' : 'Inactive'}\n                  </div>\n                </div>\n                <div className=\"space-y-4\">\n                  <p className=\"text-[12px] text-gray-400 uppercase tracking-widest leading-relaxed\">Target Model: <span className=\"text-black font-bold\">{api.model}</span></p>\n                  <input \n                    type=\"password\" \n                    value={(profile as any)[api.id]}\n                    onChange={(e) => setProfile({ ...profile, [api.id]: e.target.value })}\n                    placeholder=\"Enter API Key\"\n                    className=\"w-full bg-white border border-gray-100 rounded-xl py-3 px-4 text-[14px] focus:outline-none focus:border-[#D4AF37] transition-all\"\n                  />\n                </div>\n              </div>\n            ))}\n          </div>\n          <div className=\"mt-12 flex justify-end\">\n             <button \n               onClick={handleUpdateKeys}\n               disabled={saving}\n               className=\"px-12 py-5 bg-black text-[#D4AF37] rounded-2xl text-[14px] font-black uppercase tracking-[0.2em] hover:bg-[#D4AF37] hover:text-black transition-all shadow-xl shadow-gold/10 flex items-center gap-3 disabled:opacity-50\"\n             >\n               {saving ? <Loader2 className=\"animate-spin\" size={18} /> : 'Update All Vault Keys'}\n             </button>\n          </div>\n        </div>\n      </section>\n\n      {/* 3. REPORT ARCHIVE */}\n      <section className=\"max-w-6xl mx-auto px-8\">\n        <div className=\"bg-white border border-gray-100 rounded-[3rem] p-12 shadow-sm\">\n          <div className=\"flex items-center gap-4 mb-12\">\n            <History className=\"text-[#D4AF37]\" />\n            <h2 className=\"text-[14px] font-black uppercase tracking-[0.4em]\">Recent Analysis Archive</h2>\n          </div>\n          \n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-left\">\n              <thead>\n                <tr className=\"border-b border-gray-50\">\n                  <th className=\"pb-6 text-[12px] font-black uppercase tracking-widest text-gray-400\">Jurisdiction</th>\n                  <th className=\"pb-6 text-[12px] font-black uppercase tracking-widest text-gray-400\">Date Generated</th>\n                  <th className=\"pb-6 text-[12px] font-black uppercase tracking-widest text-gray-400\">AI Model Used</th>\n                  <th className=\"pb-6 text-right text-[12px] font-black uppercase tracking-widest text-gray-400\">Action</th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-gray-50\">\n                {[\n                  { country: \"USA to Indonesia\", date: \"Jan 03, 2026\", model: \"GPT-5.2\" },\n                  { country: \"UK to Singapore\", date: \"Jan 01, 2026\", model: \"Claude 4.5\" },\n                  { country: \"Germany to USA\", date: \"Dec 28, 2025\", model: \"Gemini 3\" }\n                ].map((row, i) => (\n                  <tr key={i} className=\"group hover:bg-[#FDFCFB]\">\n                    <td className=\"py-6 text-[14px] font-bold\">{row.country}</td>\n                    <td className=\"py-6 text-[14px] text-gray-500 font-light\">{row.date}</td>\n                    <td className=\"py-6 text-[14px] font-serif italic text-[#D4AF37]\">{row.model}</td>\n                    <td className=\"py-6 text-right\">\n                      <button className=\"inline-flex items-center gap-2 text-[12px] font-black uppercase tracking-widest text-gray-400 hover:text-black transition-colors\">\n                        <Download size={14} /> Re-Export PDF\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}